{% extends 'students/base.html' %}
{% block title %}My Wishlist{% endblock %}

{% load static %}

{% block content %}

<div class="container py-2">
	<h1 class="mb-4">My Courses</h1>
	
	<!-- Stats Row -->
	<div class="row mb-4" style="position: relative; z-index: 1; overflow: visible;">
		<div class="col-md-3 col-sm-6 mb-3">
			<div class="card stats-card">
				<div class="card-body text-center">
					<h3 class="card-title">{{ active_course_count }}</h3>
					<p class="text-muted">Active Courses</p>
				</div>
			</div>
		</div>
		<div class="col-md-3 col-sm-6 mb-3">
			<div class="card stats-card">
				<div class="card-body text-center">
					<h3 class="card-title">{{ average_progress }}%</h3>
					<p class="text-muted">Average Progress</p>
				</div>
			</div>
		</div>
		<div class="col-md-3 col-sm-6 mb-3">
			<div class="card stats-card">
				<div class="card-body text-center">
					<h3 class="card-title">{{ completed_course_count }}</h3>
					<p class="text-muted">Completed Courses</p>
				</div>
			</div>
		</div>
		<div class="col-md-3 col-sm-6 mb-3">
			<div class="card stats-card">
				<div class="card-body text-center">
					<h3 class="card-title">4.8</h3>
					<p class="text-muted">Average Rating</p>
				</div>
			</div>
		</div>
	</div>

	<!-- Courses Grid -->
	<div class="row">
		{% if enrolled_courses %}
			{% for enrollment in enrolled_courses %}
				<div class="col-lg-4 col-md-6 mb-4 d-flex">
					<a href="{% url 'content_view' enrollment.course.id %}" class="nav-link w-100" style="text-decoration: none;">  
						<div class="card h-100 d-flex flex-column rounded-top-3" style="border: solid 1px; border-style: none;">  
							<img src="{{ enrollment.course.image.url }}" 
								 class="img-fluid rounded-top-3" 
								 style="height: 30vh; object-fit: cover; object-position: top;" 
								 alt="{{ enrollment.course.title }}">
	
							<div class="card-body d-flex flex-column">
								<span class="badge 
									{% if enrollment.completed %}
										bg-success
									{% else %}
										bg-primary
									{% endif %}
									badge-custom">
									{% if enrollment.completed %}
										Completed
									{% else %}
										In Progress
									{% endif %}
								</span>



								<h5 class="card-title">{{ enrollment.course.name }}</h5>
								<p class="card-text flex-grow-1">{{ enrollment.course.description|truncatewords:12 }}</p>  <!-- flex-grow-1 to fill space -->
	
								<div class="d-flex justify-content-between align-items-center">
									<small class="text-muted">{{ enrollment.course.duration }}</small>
									<small class="text-muted">4.5 <i class="fas fa-star text-warning"></i></small>
								</div>

								<!-- Progress Bar -->
								<div class="mt-3">
									<div class="d-flex justify-content-between align-items-center mb-1">
										<small class="text-muted">Progress</small>
										<small class="fw-semibold">{{ enrollment.progress }}%</small>
									</div>
									<div class="progress" style="height: 10px; border-radius: 20px; overflow: hidden;">
										<div class="progress-bar bg-success"
											role="progressbar"
											style="width: {{ enrollment.progress }}%;"
											aria-valuenow="{{ enrollment.progress }}"
											aria-valuemin="0"
											aria-valuemax="100">
										</div>
									</div>
								</div>

							</div>
						</div>
					</a>
				</div>
			{% endfor %}
		{% else %}
			<p>You are not enrolled in any courses yet.</p>
			<a href="{% url 'view_cart' %}" class="btn btn-primary w-50">Go to Cart</a>
		{% endif %}
	</div>
	
</div>

{% endblock %}

